(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["626ed826"],{"045f":function(e,t,n){"use strict";n.r(t);var o=n("fe41"),r=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,function(){return o[e]})}(s);t["default"]=r.a},"15a7":function(e,t,n){},"1ab6":function(e,t,n){"use strict";var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("278c"));n("96cf");var s=o(n("c973"));n("551c");var a=o(n("d722")),u={user:null,getUser:function(){return this.user},fetchUser:function(e){return a.default.passport.verifyJWT(e).then(function(e){return a.default.service("users").get(e.userId)}).then(function(e){return Promise.resolve(e)})},authenticate:function(){var e=this;return console.log("auth",this.user),a.default.authenticate().then(function(t){return console.log("auth successful"),localStorage.setItem("tqks-auth",t.accessToken),e.fetchUser(t.accessToken)}).then(function(t){return console.log("got user"),e.user=t,Promise.resolve(t)}).catch(function(t){return console.log("auth failed",t),e.user=null,Promise.reject(t)})},authenticated:function(){return null!=this.user},signout:function(){var e=this;return console.log("signout"),a.default.logout().then(function(){console.log("XXX signout successful"),e.user=null}).catch(function(e){return console.log("signout failed",e),Promise.reject(e)})},onLogout:function(e){var t=this;a.default.on("logout",function(){console.log("onLogout"),t.user=null,e()})},onAuthenticated:function(e){var t=this;a.default.on("authenticated",function(n){console.log("onAuthenticate",n),t.fetchUser(n.accessToken).then(function(n){console.log("onAuthenticate got user"),t.user=n,e(t.user)}).catch(function(n){console.log("onAuthenticate get user failed",n),e(t.user)})})},register:function(e,t,n,o,r){return a.default.service("users").create({email:e,password:t,fullname:n,handle:o,homepage:r})},login:function(e,t){return a.default.authenticate({strategy:"local",email:e,password:t})},sendResetPassword:function(){var e=(0,s.default)(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.info("Auth","sendResetPassword",{email:t}),t){e.next=3;break}throw new Error("Email invalid!");case 3:return n={action:"sendResetPwd",value:{email:t}},e.prev=4,e.next=7,a.default.service("authManagement").create(n);case 7:return o=e.sent,console.info("Auth","sendResetPassword","done",{result:o}),e.abrupt("return",o);case 12:throw e.prev=12,e.t0=e["catch"](4),e.t0;case 15:case"end":return e.stop()}},e,this,[[4,12]])}));return function(t){return e.apply(this,arguments)}}(),resetPassword:function(){var e=(0,s.default)(regeneratorRuntime.mark(function e(t,n){var o,s,u,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o={action:"resetPwdLong",value:{token:t,password:n}},e.next=3,a.default.service("authManagement").create(o);case 3:if(s=e.sent,u=(0,r.default)(s,2),i=u[0],u[1],i){e.next=12;break}return notify.success("Your password was updated. You may now sign in under the new password."),e.abrupt("return",!0);case 12:notify.warning("Sorry but there was an error updating your password.");case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},i=u;t.default=i},2551:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center",attrs:{padding:!0}},[n("q-dialog",{ref:"theModal",attrs:{title:e.title},on:{ok:e.onOk,hide:e.onHide},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[n("div",{attrs:{slot:"body"},slot:"body"},[n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"email",name:"email","stack-label":"E-mail",autofocus:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),n("div",{staticClass:"row"},[n("q-input",{staticClass:"full-width",attrs:{type:"password",name:"email","stack-label":"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("q-btn",{staticClass:"q-pa-sm",attrs:{label:"Forgot your password?","text-color":"green"},on:{click:function(t){return t.preventDefault(),e.forgotPassword(t)}}})],1)])])],1)},r=[];o._withStripped=!0,n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r})},"4fc8":function(e,t,n){"use strict";n.r(t);var o=n("2551"),r=n("045f");for(var s in r)"default"!==s&&function(e){n.d(t,e,function(){return r[e]})}(s);n("5b17");var a=n("2877"),u=Object(a["a"])(r["default"],o["a"],o["b"],!1,null,null,null);u.options.__file="SignIn.vue",t["default"]=u.exports},"5b17":function(e,t,n){"use strict";var o=n("15a7"),r=n.n(o);r.a},fe41:function(e,t,n){"use strict";var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("6b54");var r=o(n("1ab6")),s={data:function(){return{showDialog:!0,email:null,password:null,title:"SignIn"}},computed:{},methods:{goHome:function(){this.$router.push({name:"home"})},onHide:function(){var e=this;setTimeout(function(){e.goHome()},50)},onOk:function(e){var t=this;this.login(this.email,this.password).then(function(e){t.$q.notify({type:"positive",message:"You are now logged in"})}).catch(function(e){t.$q.notify({type:"positive",message:"Cannot sign in, please check your e-mail or password"}),t.goHome()})},login:function(e,t){return e=e&&e.toString().toLowerCase(),r.default.login(e,t)},forgotPassword:function(e){var t=this;return console.info("SignIn","forgotPassword"),r.default.sendResetPassword(this.email.toLowerCase()).then(function(e){console.info("SignIn","forgotPassword","success",{result:e}),t.$q.notify({type:"positive",message:"Please check your email for a password reset link"}),t.$refs.theModal.hide(),t.$router.push("/home")}).catch(function(e){t.$q.notify({type:"negative",message:"There was an error resetting your password."}),console.error(e),console.error("SignIn","forgotPassword","error",{e:e})})}},mounted:function(){},beforeDestroy:function(){}};t.default=s}}]);