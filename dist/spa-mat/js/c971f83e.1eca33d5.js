(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["c971f83e"],{"1ab6":function(e,t,n){"use strict";var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n("278c"));n("96cf");var o=a(n("c973"));n("551c");var r=a(n("d722")),i={user:null,getUser:function(){return this.user},fetchUser:function(e){return r.default.passport.verifyJWT(e).then(function(e){return r.default.service("users").get(e.userId)}).then(function(e){return Promise.resolve(e)})},authenticate:function(){var e=this;return console.log("auth",this.user),r.default.authenticate().then(function(t){return console.log("auth successful"),localStorage.setItem("tqks-auth",t.accessToken),e.fetchUser(t.accessToken)}).then(function(t){return console.log("got user"),e.user=t,Promise.resolve(t)}).catch(function(t){return console.log("auth failed",t),e.user=null,Promise.reject(t)})},authenticated:function(){return null!=this.user},signout:function(){var e=this;return console.log("signout"),r.default.logout().then(function(){console.log("XXX signout successful"),e.user=null}).catch(function(e){return console.log("signout failed",e),Promise.reject(e)})},onLogout:function(e){var t=this;r.default.on("logout",function(){console.log("onLogout"),t.user=null,e()})},onAuthenticated:function(e){var t=this;r.default.on("authenticated",function(n){console.log("onAuthenticate",n),t.fetchUser(n.accessToken).then(function(n){console.log("onAuthenticate got user"),t.user=n,e(t.user)}).catch(function(n){console.log("onAuthenticate get user failed",n),e(t.user)})})},register:function(e,t,n,a,s){return r.default.service("users").create({email:e,password:t,fullname:n,handle:a,homepage:s})},login:function(e,t){return r.default.authenticate({strategy:"local",email:e,password:t})},sendResetPassword:function(){var e=(0,o.default)(regeneratorRuntime.mark(function e(t){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.info("Auth","sendResetPassword",{email:t}),t){e.next=3;break}throw new Error("Email invalid!");case 3:return n={action:"sendResetPwd",value:{email:t}},e.prev=4,e.next=7,r.default.service("authManagement").create(n);case 7:return a=e.sent,console.info("Auth","sendResetPassword","done",{result:a}),e.abrupt("return",a);case 12:throw e.prev=12,e.t0=e["catch"](4),e.t0;case 15:case"end":return e.stop()}},e,this,[[4,12]])}));return function(t){return e.apply(this,arguments)}}(),resetPassword:function(){var e=(0,o.default)(regeneratorRuntime.mark(function e(t,n){var a,o,i,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a={action:"resetPwdLong",value:{token:t,password:n}},e.next=3,r.default.service("authManagement").create(a);case 3:if(o=e.sent,i=(0,s.default)(o,2),u=i[0],i[1],u){e.next=12;break}return notify.success("Your password was updated. You may now sign in under the new password."),e.abrupt("return",!0);case 12:notify.warning("Sorry but there was an error updating your password.");case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},u=i;t.default=u},"41c4":function(e,t,n){"use strict";n.r(t);var a=n("e039"),s=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);t["default"]=s.a},"56b4":function(e,t,n){"use strict";n.r(t);var a=n("be0a"),s=n("41c4");for(var o in s)"default"!==o&&function(e){n.d(t,e,function(){return s[e]})}(o);n("e7b9");var r=n("2877"),i=Object(r["a"])(s["default"],a["a"],a["b"],!1,null,null,null);i.options.__file="Register.vue",t["default"]=i.exports},be0a:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center",attrs:{padding:!0}},[n("div",{staticClass:"panel-body"},[n("h6",[e._v("Register")]),n("div",{attrs:{slot:"body"},slot:"body"},[n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"email",name:"email","stack-label":"E-mail",autofocus:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"text",name:"fname","stack-label":"Full Name",autofocus:""},model:{value:e.fullName,callback:function(t){e.fullName=t},expression:"fullName"}})],1),n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"text",name:"handle","stack-label":"Handle",autofocus:""},model:{value:e.handle,callback:function(t){e.handle=t},expression:"handle"}})],1),n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"text",name:"homepage","stack-label":"Homepage",autofocus:""},model:{value:e.homepage,callback:function(t){e.homepage=t},expression:"homepage"}})],1),n("div",{staticClass:"row q-mb-md"},[n("q-input",{staticClass:"full-width",attrs:{type:"password",name:"email","stack-label":"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)]),n("div",[n("q-btn",{attrs:{label:"Register"},on:{click:e.doRegister}}),n("q-btn",{attrs:{label:"Cancel"},on:{click:function(t){return e.$router.replace("/home")}}})],1)])])},s=[];a._withStripped=!0,n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s})},be5a:function(e,t,n){},e039:function(e,t,n){"use strict";var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(n("1ab6")),o=(a(n("ace7")),a(n("d722"))),r=(o.default.service("invitations"),{data:function(){return{showDialog:!0,email:null,handle:null,homepage:null,fullName:null,password:null,title:"Register"}},computed:{},methods:{goHome:function(){this.$router.push({name:"home"})},onHide:function(){var e=this;setTimeout(function(){e.goHome()},50)},canRegister:function(e,t){var n=!0;return t(n)},doRegister:function(){console.info("Register-1",this.$data.email);var e=this.$data.email,t=this.$data.handle,n=this.$data.fullName;if(e)if(t)if(n)if(this.$data.password){var a=this;this.canRegister(e,function(s){console.info("Register-2",s),s?a.register(e,a.$data.password,n,t,a.$data.homepage).then(function(e){a.$q.notify({type:"positive",message:"Please check your email for verification!"}),a.goHome()}).catch(function(e){a.$q.notify({type:"positive",message:"Cannot register, please check your e-mail or password"})}):(a.$q.notify({type:"negative",message:"Cannot register, email not found on invitations list"}),a.goHome())})}else this.$q.notify({type:"negative",message:"Missing Password"});else this.$q.notify({type:"negative",message:"Missing FullName"});else this.$q.notify({type:"negative",message:"Missing Handle"});else this.$q.notify({type:"negative",message:"Missing Email"})},register:function(e,t,n,a,o){return s.default.register(e,t,n,a,o)},login:function(e,t){return s.default.login(e,t)}},mounted:function(){},beforeDestroy:function(){}});t.default=r},e7b9:function(e,t,n){"use strict";var a=n("be5a"),s=n.n(a);s.a}}]);