{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"e149aa4c\"],{\"11f6\":function(e,n,t){\"use strict\";var a=t(\"4ea4\");Object.defineProperty(n,\"__esModule\",{value:!0}),n.default=void 0,t(\"7514\"),t(\"28a5\"),t(\"a481\"),t(\"96cf\");var r=a(t(\"c973\")),i=a(t(\"d722\")),s=i.default.service(\"conversation\"),o=i.default.service(\"tags\"),c={props:[\"user\"],data:function(){return{labels:\"\",parentId:\"\"}},methods:{doSubmit:function(){var e=(0,r.default)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.processLabels();case 1:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),replaceSpaces:function(e){return e.replace(/ /g,\"_\")},labelToId:function(e){var n=this.replaceSpaces(e);return n.toLowerCase()},processLabels:function(){console.info(\"Tagomizer\",this.labels);var e=this.labels.split(\",\"),n=e.length;console.info(\"TX\",n);var t=[];if(n>0)for(var a=0;a<n;a++)console.info(\"TY\",e[a]),t.push(e[a].trim());else\"\"!==e&&t.push(e.trim());console.info(\"TagProcessLabels\",t.length),t.length>0&&this.findOrCreateTags(t)},grabTag:function(e,n){o.find({query:{nodeId:e,skippop:!0}}).then(function(e){return n(e.data[0])}).catch(function(e){return console.info(\"TagFindeOrCreate Error\",e),n(void 0)})},findOrCreateTag:function(e,n){console.info(\"NT\",e);var t=this.labelToId(e);console.info(\"NT-1\",t);var a=this;this.grabTag(t,function(r){if(console.info(\"NT-2\",r),r)return n(r);console.info(\"NTC\");var i={};i.nodeId=t,i.label=e,i.creator=a.user._id,i.handle=a.user.handle,i.date=new Date,i.type=\"tag\",i.img=\"statics/images/tag.png\",i.imgsm=\"statics/images/tag_sm.png\",o.create(i).then(function(e){return console.info(\"TagCreate\",e),n(e)})})},findOrCreateTags:function(e){e.length;var n,t=this;function a(){if(0===e.length)return console.info(\"TA0\"),t.$router.push({name:\"questview\",params:{id:t.parentId}});n=e.pop(),n&&\"\"!==n?(console.info(\"TA\",n),t.findOrCreateTag(n,function(e){console.info(\"TB\",e),t.processTag(e),a()})):a()}a()},processTag:function(e){console.info(\"TagProcess\",e);var n=e.nodes;n||(n=[]);var t=n.indexOf(this.parentId);t<0&&(n.push(this.parentId),e.nodes=n,console.info(\"TagProcess-1\",e),o.update(e.id,e).then(function(e){})),s.find({query:{nodeId:this.parentId,skippop:!0}}).then(function(n){var t=n.data[0];console.info(\"TagProcess-2\",t);var a=t.tags;a||(a=[]);var r=a.indexOf(e.id);r<0&&(a.push(e.id),t.tags=a,s.update(t.id,t).then(function(e){console.info(\"TagProcess-3\",e)})),console.info(\"TagProcess-4\")})}},mounted:function(){this.$store.commit(\"questView\",!1),this.$data.parentId=this.$route.params.id}};n.default=c},5392:function(e,n,t){\"use strict\";var a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t(\"q-page\",{attrs:{padding:!0}},[t(\"h4\",[t(\"img\",{staticStyle:{\"margin-right\":\"4px\"},attrs:{src:\"statics/images/tag.png\"}}),e._v(\"New Tag\")]),t(\"div\",{attrs:{id:\"newtagview\"}},[t(\"div\",{attrs:{id:\"tagform\"}},[t(\"b\",[e._v(\"Tag Labels (comma separated)\")]),t(\"br\"),t(\"q-input\",{attrs:{required:\"\"},model:{value:e.labels,callback:function(n){e.labels=n},expression:\"labels\"}}),t(\"br\"),t(\"br\"),t(\"b\",[e._v(\"Note:\")]),e._v(\" Tag labels cannot include characters such as ' @ # $. They can include spaces.\"),t(\"br\"),e._v('\\n      If a tag such as \"My First Tag\" is new, that is the tag which will prevail, even if \\n      e.g. \"my first Tag\" is later entered.'),t(\"br\"),t(\"br\"),e._v('\\n      Tags are important markers of topics: in that case using upper case such as \"My Topic\"'),t(\"br\"),e._v(\"\\n      is a reasonable policy.\\n      \"),t(\"br\"),t(\"br\"),t(\"q-btn\",{attrs:{label:\"Submit\"},on:{click:e.doSubmit}}),t(\"q-btn\",{attrs:{label:\"Cancel\"},on:{click:function(n){return e.$router.replace(\"/home\")}}})],1)])])},r=[];a._withStripped=!0,t.d(n,\"a\",function(){return a}),t.d(n,\"b\",function(){return r})},\"7e72\":function(e,n,t){},\"8f09\":function(e,n,t){\"use strict\";var a=t(\"7e72\"),r=t.n(a);r.a},b46e:function(e,n,t){\"use strict\";t.r(n);var a=t(\"5392\"),r=t(\"c6d5\");for(var i in r)\"default\"!==i&&function(e){t.d(n,e,function(){return r[e]})}(i);t(\"8f09\");var s=t(\"2877\"),o=Object(s[\"a\"])(r[\"default\"],a[\"a\"],a[\"b\"],!1,null,null,null);o.options.__file=\"TagForm.vue\",n[\"default\"]=o.exports},c6d5:function(e,n,t){\"use strict\";t.r(n);var a=t(\"11f6\"),r=t.n(a);for(var i in a)\"default\"!==i&&function(e){t.d(n,e,function(){return a[e]})}(i);n[\"default\"]=r.a}}]);","extractedComments":[]}